
/**
 * @module       RDFacebookFeed
 * @author       Rafael Shayvolodyan
 * @see          https://ua.linkedin.com/in/rafael-shayvolodyan-3a297b96
 * @version      1.0.3
 */
(function(){(function(m,t,q){var r=function(){function h(c,f){this.options=m.extend(!0,{},this.Defaults,f);this.element=c;this.$element=m(c);this.$win=m(q);this.$doc=m(t);this.$items=this.$element.find("[data-fb-post]");this.$user=this.$element.find("[data-fb-user]");this.initialize()}h.prototype.Defaults={id:"",accessToken:"",showLog:!1,dateFormat:{seconds:"less than a minute ago",minute:"about a minute ago",minutes:" minutes ago",hour:"about an hour ago",hours:" hours ago",day:"1 day ago",days:"%b/%d/%Y"},
  callbacks:{userLoaded:!1,postsLoaded:!1}};h.prototype.initialize=function(){var c=this;var f=this.element.getAttribute("data-fb-id")?this.element.getAttribute("data-fb-id"):this.options.id;var e=this.element.getAttribute("data-fb-id")?this.element.getAttribute("data-fb-id"):this.options.id;var b=this.element.getAttribute("data-fb-access")?this.element.getAttribute("data-fb-access"):this.options.accessToken;if(!f)throw Error("You need to provide an user/page id!");if(!b)throw Error("You need to provide an access token!");
  var a=this.element.getAttribute("data-fb-page-type");queryModificator="posts";switch(a){case "user":queryModificator="me/feed";f="";e="me";break;case "group":queryModificator="feed"}f="https://graph.facebook.com/v2.9/"+f+"/"+queryModificator+"/?fields=message,picture,likes,actions,comments,name,created_time&access_token="+b+"&date_format=U&limit=20";m.when(m.getJSON("https://graph.facebook.com/v2.9/"+e+"/?fields=name,picture&access_token="+b+""),m.getJSON(f)).done(function(a,b){if("true"===c.element.getAttribute("data-fb-showlog")?
          c.element.getAttribute("data-fb-showlog"):c.options.showLog)console.log("User: "),console.log(a[0]),console.log("Posts: "),console.log(b[0].data);var d=a[0];var f=[];m.each(b[0].data,function(){var a;if(!this.message)return!0;this.from={};d.picture&&(this.from.picture=d.picture.data.url);this.from.name=d.name;this.message=c.urlHyperlinks(this.message);this.likes?this.likes.count=this.likes.data.length:(this.likes=[],this.likes.count=0);this.comments?this.comments.count=this.comments.data.length:(this.comments=
      [],this.comments.count=0);null!=this.actions?null!=this.actions[0]&&"Share"===this.actions[0].name&&(this.postlink=this.actions[0].link):this.postlink=this.link;if(null!=this.comments.data){var b=this.comments.data;var e=0;for(a=b.length;e<a;e++){var g=b[e];g.from.link="https://facebook.com/"+g.from.id}}f.push(this)});c.loopData(d,!0);c.loopData(f,!1)})};h.prototype.dating=function(c,f){var e;var b=new Date(1E3*c);var a=new Date;var d=parseInt((a.getTime()-b.getTime())/1E3);d+=60*(-120-a.getTimezoneOffset());
  a="January February March April May June July August September October November December".split(" ");b={"%d":b.getDate(),"%m":b.getMonth()+1,"%b":a[b.getMonth()].substring(0,3),"%B":a[b.getMonth()],"%y":String(b.getFullYear()).slice(-2),"%Y":b.getFullYear()};if(f){a="%Y-%m-%d";var k=a.match(/%[dmbByY]/g);var g=0;for(e=k.length;g<e;g++)d=k[g],a=a.replace(d,b[d]);return a}a=this.element.getAttribute("data-fb-date-format")?this.element.getAttribute("data-fb-date-format"):this.options.dateFormat.days;
  if(60>d)return this.options.dateFormat.seconds;if(120>d)return this.options.dateFormat.minute;if(3600>d)return parseInt(d/60).toString()+this.options.dateFormat.minutes;if(7200>d)return this.options.dateFormat.hour;if(86400>d)return"about "+parseInt(d/3600).toString()+this.options.dateFormat.hours;if(172800>d)return this.options.dateFormat.day;k=a.match(/%[dmbByY]/g);g=0;for(e=k.length;g<e;g++)d=k[g],a=a.replace(d,b[d]);return a};h.prototype.urlHyperlinks=function(c){return c.replace(/\b((http|https):\/\/\S+)/g,
    '<a href="$1" target="_blank">$1</a>')};h.prototype.loopData=function(c,f){var e,b;var a=this;null!=a.interval&&clearInterval(a.interval);if(f)a.$user.find("*").each(function(){return a.parseAttributes(this,c,0)}),a.options.callbacks.userLoaded&&a.options.callbacks.userLoaded.call(this,a);else{if(Array.isArray(c))for(b=0;b<c.length;){var d=e=-1;a.$items.eq(b).find("*").each(function(){a.checkAttribute(this,"data-fb-like")?e++:a.checkAttribute(this,"data-fb-comment")?d++:a.checkAttribute(this,"data-likes")?
    a.parseAttributes(this,c[b],e):a.checkAttribute(this,"data-comments")?a.parseAttributes(this,c[b],d):a.parseAttributes(this,c[b],0)});b++}a.options.callbacks.postsLoaded&&a.options.callbacks.postsLoaded.call(this,a)}};h.prototype.checkAttribute=function(c,f){var e;var b=c.attributes;var a=0;for(e=b.length;a<e;a++){var d=b[a];if(-1<d.name.indexOf(f))return!0}return!1};h.prototype.parseAttributes=function(c,f,e){var b,a,d,k;var g=c.attributes;for(b in g)if((!g[b].name||"data-x"!==g[b].name.substring(0,
        6))&&null!=g[b]&&"data-remove"!==g[b].name&&"object"===typeof g[b]&&-1!==g[b].name.indexOf("data-")&&-1===g[b].name.indexOf("data-fb-")){var h=g[b].name.substring(5);var l=null;if(-1!==h.indexOf("-")){var q=h.split("-");l=f;var p=0;for(d=q.length;p<d;p++){var n=q[p];"data"===n&&null!=l[n]&&null!=l[n][e]?l=l[n][e]:null!=l[n]?l=l[n]:c.hasAttribute("data-remove")&&m(c).remove()}}if("string"===typeof g[b].value&&(p=g[b].value.split(/\s?,\s?/i),null!=l?k=l:null!=f[h]&&(k=f[h]),-1!==h.indexOf("created_time")&&
    (a=k),null!=k&&null!=p&&("string"===typeof k||"number"===typeof k)))for(d=0,n=p.length;d<n;d++)l=p[d],-1!==h.indexOf("created_time")&&(k="datetime"===l?this.dating(a,!0):this.dating(a,!1)),"text"===l.toLowerCase()?c.innerHTML=k:c.setAttribute(l,k)}};h.prototype.getOption=function(c){var f,e;if(null!=this.options.responsive){for(f in this.options.responsive)f<=q.innerWidth&&(e=f);return null!=this.options.responsive[e][c]?this.options.responsive[e][c]:this.options[c]}return this.options[c]};return h}();
  m.fn.extend({RDFacebookFeed:function(h){return this.each(function(){var c=m(this);if(!c.data("RDFacebookFeed"))return c.data("RDFacebookFeed",new r(this,h))})}});return q.RDFacebookFeed=r})(window.jQuery,document,window);"undefined"!==typeof module&&null!==module?module.exports=window.RDFacebookFeed:"function"===typeof define&&define.amd&&define(["jquery"],function(){return window.RDFacebookFeed})}).call(this);